{"remainingRequest":"/Users/mac/Desktop/permissions-web/node_modules/babel-loader/lib/index.js!/Users/mac/Desktop/permissions-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/mac/Desktop/permissions-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mac/Desktop/permissions-web/src/views/task/taskEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mac/Desktop/permissions-web/src/views/task/taskEdit.vue","mtime":1648622063190},{"path":"/Users/mac/Desktop/permissions-web/babel.config.js","mtime":1647345364000},{"path":"/Users/mac/Desktop/permissions-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/permissions-web/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/mac/Desktop/permissions-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/mac/Desktop/permissions-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.link\";\nimport \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar THIS;\nimport botHeader from '@/views/components/bot-header/bot-header';\nimport submitBtn from '@/views/components/form-submit/submit-btn';\nexport default {\n  components: {\n    botHeader: botHeader,\n    submitBtn: submitBtn\n  },\n  name: '',\n  data: function data() {\n    return {\n      id: '',\n      userType: 2,\n      isBack: true,\n      link: '/home/task/taskOne/taskList',\n      msg: {},\n      ruleForm: {\n        name: '',\n        mid: '',\n        type: '',\n        address: '',\n        desc: '',\n        standard: '',\n        cycle: '',\n        fee: '',\n        pid: '',\n        cooperation: '',\n        report: '',\n        number: '',\n        education: ''\n      },\n      rules: {\n        name: [{\n          required: true,\n          message: '请输入任务名称',\n          trigger: []\n        }],\n        mid: [{\n          required: true,\n          message: '请输入发包方',\n          trigger: []\n        }],\n        address: [{\n          required: true,\n          message: '请输入任务城市',\n          trigger: []\n        }],\n        desc: [{\n          required: true,\n          message: '请输入任务描述',\n          trigger: []\n        }],\n        type: [{\n          required: true,\n          message: '请选择用工类型',\n          trigger: []\n        }],\n        standard: [{\n          required: true,\n          message: '请输入验收标准',\n          trigger: []\n        }],\n        cycle: [{\n          required: true,\n          message: '请选择结算周期',\n          trigger: []\n        }],\n        fee: [{\n          required: true,\n          message: '请输入服务费',\n          trigger: []\n        }],\n        pid: [{\n          required: true,\n          message: '请选择服务商名称',\n          trigger: []\n        }],\n        cooperation: [{\n          required: true,\n          message: '请选择结算周期',\n          trigger: []\n        }],\n        report: [{\n          required: true,\n          message: '请选择报名期限',\n          trigger: []\n        }],\n        number: [{\n          required: true,\n          message: '请输入接单人数',\n          trigger: []\n        }],\n        education: [{\n          required: true,\n          message: '请选择学历要求',\n          trigger: []\n        }]\n      },\n      pidArr: [],\n      midArr: [],\n      typeArr: [],\n      cycleArr: [{\n        title: '按单结算',\n        id: 1\n      }, {\n        title: '按小时结算',\n        id: 2\n      }, {\n        title: '按月结算',\n        id: 3\n      }, {\n        title: '按日结算',\n        id: 4\n      }],\n      educationArr: [{\n        title: '无限制',\n        id: 1\n      }, {\n        title: '初中以上',\n        id: 2\n      }, {\n        title: '高中以上',\n        id: 3\n      }, {\n        title: '大专以上',\n        id: 4\n      }, {\n        title: '本科以上',\n        id: 5\n      }]\n    };\n  },\n  methods: {\n    submitForm: function submitForm(formName) {\n      THIS.$refs[formName].validate(function (valid) {\n        console.log('valid', valid);\n\n        if (valid) {\n          THIS.submit_from();\n        } else {\n          THIS.$message({\n            type: 'warning',\n            message: '请将必填项完善后再提交',\n            dangerouslyUseHTMLString: true\n          });\n          return false;\n        }\n      });\n    },\n    resetForm: function resetForm(formName) {\n      THIS.$refs[formName].resetFields();\n    },\n    submit_from: function submit_from() {\n      var data = {\n        name: THIS.ruleForm.name,\n        mid: THIS.ruleForm.mid,\n        type: THIS.ruleForm.type,\n        address: THIS.ruleForm.address,\n        desc: THIS.ruleForm.desc,\n        standard: THIS.ruleForm.standard,\n        cycle: THIS.ruleForm.cycle,\n        fee: THIS.ruleForm.fee,\n        pid: THIS.ruleForm.pid,\n        cooperation_start: THIS.ruleForm.cooperation[0],\n        cooperation_end: THIS.ruleForm.cooperation[1],\n        report_start: THIS.ruleForm.report[0],\n        report_end: THIS.ruleForm.report[1],\n        number: THIS.ruleForm.number,\n        education: THIS.ruleForm.education\n      };\n      var url = '';\n\n      if (THIS.id) {\n        data.id = THIS.id;\n        url = '/task/edit';\n      } else {\n        url = '/task/add';\n      }\n\n      ;\n      vue_Post(THIS, url, data, callback, 1, 1, 1, 1);\n\n      function callback(msg) {\n        THIS.$message({\n          type: 'success',\n          message: THIS.id ? '编辑成功' : '创建成功',\n          dangerouslyUseHTMLString: true\n        });\n        THIS.isBack = false;\n        THIS.$router.replace(THIS.link);\n      }\n\n      ;\n    },\n    get_detail: function get_detail() {\n      var data = {\n        id: THIS.id\n      };\n      vue_Post(THIS, '/task/get', data, callback, 1, 1, 0, 1);\n\n      function callback(msg) {\n        msg = msg.info;\n        THIS.ruleForm = {\n          name: msg.name,\n          mid: msg.mid,\n          type: msg.type,\n          address: msg.address,\n          desc: msg.desc,\n          standard: msg.standard,\n          cycle: msg.cycle,\n          fee: msg.fee,\n          pid: msg.pid,\n          cooperation: [msg.cooperation_start, msg.cooperation_end],\n          report: [msg.report_start, msg.report_end],\n          number: msg.number,\n          education: msg.education\n        };\n        THIS.get_type();\n      }\n    },\n    //获取服务商\n    search_pid: function search_pid(msg) {\n      var data = {\n        name: msg,\n        size: 300\n      };\n      vue_Post(THIS, '/platform/list', data, callback, 0, 0, 0, 0);\n\n      function callback(msg) {\n        THIS.pidArr = msg.list.map(function (item) {\n          return {\n            title: item.name,\n            id: item.id\n          };\n        });\n      }\n    },\n    //获取发包方\n    search_mid: function search_mid(msg) {\n      var data = {\n        name: msg,\n        size: 300\n      };\n      vue_Post(THIS, '/merchant/list', data, callback, 0, 0, 0, 0);\n\n      function callback(msg) {\n        console.log(1000);\n        THIS.midArr = msg.list.map(function (item) {\n          return {\n            title: item.m_name,\n            id: item.id\n          };\n        });\n      }\n    },\n    get_type: function get_type() {\n      var data = {\n        id: THIS.ruleForm.mid\n      };\n      vue_Post(THIS, '/merchant/getProtocol', data, callback, 0, 0, 0, 0);\n\n      function callback(msg) {\n        THIS.typeArr = msg;\n        console.log(THIS.typeArr);\n      }\n    },\n    changeMid: function changeMid(flag) {\n      if (!flag && THIS.ruleForm.mid) {\n        THIS.get_type();\n      }\n\n      ;\n    }\n  },\n  mounted: function mounted() {\n    THIS = this;\n    THIS.store.commit('setPageText', '任务管理 / 任务编辑');\n    THIS.id = THIS.$route.params.id ? THIS.$route.params.id : '';\n    THIS.userType = window.localStorage.userType;\n\n    if (THIS.id) {\n      THIS.get_detail();\n    } else {\n      THIS.get_type();\n    }\n\n    ;\n    THIS.search_pid('');\n    THIS.search_mid('');\n  },\n  beforeDestroy: function beforeDestroy() {\n    THIS.store.commit('setPageText', '当前位置：任务管理 / 任务列表');\n  },\n  beforeRouteLeave: function beforeRouteLeave(to, from, next) {\n    //删除：清除缓存页面缓存  返回：缓存上一页面\n    if (!THIS.isBack) {\n      to.meta.keepAlive = false;\n    }\n\n    ;\n    next();\n  }\n};",{"version":3,"mappings":"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","names":["components","botHeader","submitBtn","name","data","id","userType","isBack","link","msg","ruleForm","mid","type","address","desc","standard","cycle","fee","pid","cooperation","report","number","education","rules","required","message","trigger","pidArr","midArr","typeArr","cycleArr","title","educationArr","methods","submitForm","formName","THIS","console","dangerouslyUseHTMLString","resetForm","submit_from","cooperation_start","cooperation_end","report_start","report_end","url","vue_Post","get_detail","search_pid","size","search_mid","get_type","changeMid","flag","mounted","beforeDestroy","beforeRouteLeave","to","from","next"],"sourceRoot":"src/views/task","sources":["taskEdit.vue"],"sourcesContent":["<template>\r\n\r\n\r\n          <div class=\"views h_bottom po_r pad_l_50 pad_r_50 b_s mr_color01\">\r\n                \r\n                <bot-header :link='link'></bot-header>\r\n                <el-form :model=\"ruleForm\" label-position='top' :rules=\"rules\" ref=\"ruleForm\" class=\"views_100ch_2 demo-ruleForm\">\r\n                        <div class=\"views_100ch_2\">\r\n                            <div class=\"from_box\">\r\n                                <div class=\"from_tltle\">基本信息</div>\r\n                                <div class=\"w_100 b_s pad_l_30 pad_r_30 mar_t_30\">\r\n                                    <div class=\"w_100\">\r\n                                        <div class=\"w_100 flex row j_between\">\r\n                                            <el-form-item class=\"w_30\" label=\"任务名称\" prop=\"name\">\r\n                                                <el-input v-model=\"ruleForm.name\" placeholder=\"请输入任务名称\" clearable></el-input>\r\n                                            </el-form-item>\r\n                                            <el-form-item class=\"w_30\" label=\"任务城市\" prop=\"address\">\r\n                                                <el-input v-model=\"ruleForm.address\" placeholder=\"请输入任务城市\" clearable></el-input>\r\n                                            </el-form-item>\r\n                                            <el-form-item class=\"w_30\" v-if=\"userType==1\" label=\"发包方\" prop=\"mid\">\r\n                                                <el-select @visible-change=\"changeMid($event)\" class=\"w_100 d_b_line\" v-model=\"ruleForm.mid\" remote :remote-method='search_mid' clearable filterable  placeholder=\"请选择发包方\">\r\n                                                    <el-option v-for=\"(item,index) in midArr\" :key=\"index\" :label=\"item.title\" :value=\"item.id\"></el-option>\r\n                                                </el-select>\r\n                                            </el-form-item>\r\n                                            <div v-else class=\"w_30\"></div>\r\n                                        </div>\r\n                                        <div class=\"w_100 flex row j_between\">\r\n                                            <el-form-item class=\"w_30\" label=\"用工类型\" prop=\"type\">\r\n                                                <el-select class=\"w_100 d_b_line\" v-model=\"ruleForm.type\" clearable filterable placeholder=\"请选择用工类型\">\r\n                                                    <el-option v-for=\"(item,index) in typeArr\" :key=\"index\" :label=\"item.name\" :value=\"item.id\"></el-option>\r\n                                                </el-select>\r\n                                            </el-form-item>\r\n                                            <el-form-item label=\"任务描述\" prop=\"desc\" class=\"w_30 mar_r_30\">\r\n                                                <el-input type=\"textarea\" :rows=\"4\" v-model=\"ruleForm.desc\" placeholder=\"请输入任务描述\"></el-input>\r\n                                            </el-form-item>\r\n                                            <el-form-item label=\"验收标准\" prop=\"standard\" class=\"w_30\">\r\n                                                <el-input type=\"textarea\" :rows=\"4\" v-model=\"ruleForm.standard\" placeholder=\"请输入验收标准\"></el-input>\r\n                                            </el-form-item>\r\n                                        </div>\r\n                                        <div class=\"w_100 flex row j_between\">\r\n                                            <el-form-item class=\"w_30\" label=\"结算周期\" prop=\"cycle\">\r\n                                                <el-select class=\"w_100 d_b_line\" v-model=\"ruleForm.cycle\" clearable filterable placeholder=\"请选择结算周期\">\r\n                                                    <el-option v-for=\"(item,index) in cycleArr\" :key=\"index\" :label=\"item.title\" :value=\"item.id\"></el-option>\r\n                                                </el-select>\r\n                                            </el-form-item>\r\n                                            <el-form-item class=\"w_30\" label=\"服务费\" prop=\"fee\">\r\n                                                <el-input v-model=\"ruleForm.fee\" placeholder=\"请输入服务费\" oninput=\"value=value.replace(/[^\\d\\.]/g,'')\" clearable></el-input>\r\n                                            </el-form-item>\r\n                                            <el-form-item class=\"w_30\" label=\"学历要求\" prop=\"education\">\r\n                                                <el-select class=\"w_100 d_b_line\" v-model=\"ruleForm.education\" clearable filterable placeholder=\"请选择学历要求\">\r\n                                                    <el-option v-for=\"(item,index) in educationArr\" :key=\"index\" :label=\"item.title\" :value=\"item.id\"></el-option>\r\n                                                </el-select>\r\n                                            </el-form-item>\r\n                                        </div>\r\n                                        <div class=\"w_100 flex row j_between\">\r\n                                            <el-form-item class=\"w_30\" label=\"合作期限\" prop=\"cooperation\">\r\n                                                <el-date-picker\r\n                                                    style='width:100%'\r\n                                                    v-model=\"ruleForm.cooperation\"\r\n                                                    value-format=\"yyyy-MM-dd\"\r\n                                                    type=\"daterange\"\r\n                                                    range-separator=\"至\"\r\n                                                    start-placeholder=\"开始日期\"\r\n                                                    end-placeholder=\"结束日期\">\r\n                                                </el-date-picker>\r\n                                            </el-form-item>\r\n                                            <el-form-item class=\"w_30\" label=\"报名期限\" prop=\"report\">\r\n                                                <el-date-picker\r\n                                                    style='width:100%'\r\n                                                    v-model=\"ruleForm.report\"\r\n                                                    value-format=\"yyyy-MM-dd\"\r\n                                                    type=\"daterange\"\r\n                                                    range-separator=\"至\"\r\n                                                    start-placeholder=\"开始日期\"\r\n                                                    end-placeholder=\"结束日期\">\r\n                                                </el-date-picker>\r\n                                            </el-form-item>\r\n                                            <el-form-item class=\"w_30\" label=\"接单人数\" prop=\"number\">\r\n                                                <el-input v-model=\"ruleForm.number\" oninput=\"value=value.replace(/[^\\d]/g,'')\" placeholder=\"请输入接单人数\" clearable></el-input>\r\n                                            </el-form-item>\r\n                                        </div>\r\n                                        <div v-if=\"userType==1\" class=\"w_100 flex row j_between\">\r\n                                            <el-form-item class=\"w_30\" label=\"服务商\" prop=\"pid\">\r\n                                                <el-select class=\"w_100 d_b_line\" v-model=\"ruleForm.pid\" remote :remote-method='search_pid' clearable filterable  placeholder=\"请选择服务商名称\">\r\n                                                    <el-option v-for=\"(item,index) in pidArr\" :key=\"index\" :label=\"item.title\" :value=\"item.id\"></el-option>\r\n                                                </el-select>\r\n                                            </el-form-item>\r\n                                            <div class=\"w_30\"></div>\r\n                                            <div class=\"w_30\"></div>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                </el-form>\r\n                <div class=\"po_b po_bottom bg_fff h_60px w_100\">\r\n                    <submit-btn @submitForm='submitForm' @resetForm='resetForm'></submit-btn>\r\n                </div>\r\n\r\n          </div>\r\n  \r\n</template>\r\n\r\n<script>\r\nvar THIS;\r\nimport botHeader from '@/views/components/bot-header/bot-header';\r\nimport submitBtn from '@/views/components/form-submit/submit-btn';\r\nexport default {\r\n    components:{\r\n        botHeader,\r\n        submitBtn\r\n    },\r\n    name: '',\r\n    data(){\r\n        return {\r\n            id:'',\r\n            userType:2,\r\n            isBack:true,\r\n            link:'/home/task/taskOne/taskList',\r\n            msg:{},\r\n            ruleForm:{\r\n                name:'',\r\n                mid:'',\r\n                type:'',\r\n                address:'',\r\n                desc:'',\r\n                standard:'',\r\n                cycle:'',\r\n                fee:'',\r\n                pid:'',\r\n                cooperation:'',\r\n                report:'',\r\n                number:'',\r\n                education:'',\r\n            },  \r\n            rules:{\r\n                name:[{ required: true, message: '请输入任务名称', trigger: [] }],\r\n                mid:[{ required: true, message: '请输入发包方', trigger: [] }],\r\n                address:[{ required: true, message: '请输入任务城市', trigger: [] }],\r\n                desc:[{ required: true, message: '请输入任务描述', trigger: [] }],\r\n                type:[{ required: true, message: '请选择用工类型', trigger: [] }],\r\n                standard:[{ required: true, message: '请输入验收标准', trigger: [] }],\r\n                cycle:[{ required: true, message: '请选择结算周期', trigger: [] }],\r\n                fee:[{ required: true, message: '请输入服务费', trigger: [] }],\r\n                pid:[{ required: true, message: '请选择服务商名称', trigger: [] }],\r\n                cooperation:[{ required: true, message: '请选择结算周期', trigger: [] }],\r\n                report:[{ required: true, message: '请选择报名期限', trigger: [] }],\r\n                number:[{ required: true, message: '请输入接单人数', trigger: [] }],\r\n                education:[{ required: true, message: '请选择学历要求', trigger: [] }],\r\n            },\r\n            pidArr:[],\r\n            midArr:[],\r\n            typeArr:[],\r\n            cycleArr:[\r\n                { title:'按单结算',id:1 },\r\n                { title:'按小时结算',id:2 },\r\n                { title:'按月结算',id:3 },\r\n                { title:'按日结算',id:4 }\r\n            ],\r\n            educationArr:[\r\n                { title:'无限制',id:1 },\r\n                { title:'初中以上',id:2 },\r\n                { title:'高中以上',id:3 },\r\n                { title:'大专以上',id:4 },\r\n                { title:'本科以上',id:5 }\r\n            ]\r\n        }\r\n    },\r\n    methods:{\r\n\r\n            submitForm(formName) {\r\n                    THIS.$refs[formName].validate((valid) => {\r\n                        console.log('valid',valid)\r\n                        if (valid) {\r\n                            THIS.submit_from();\r\n                        } else {\r\n                            THIS.$message({\r\n                                    type: 'warning',\r\n                                    message: '请将必填项完善后再提交',\r\n                                    dangerouslyUseHTMLString:true\r\n                                });\r\n                            return false;\r\n                        }\r\n                    });\r\n            },\r\n\r\n            resetForm(formName) {\r\n                    THIS.$refs[formName].resetFields();\r\n            },\r\n\r\n            submit_from(){\r\n                    var data = {\r\n                        name:THIS.ruleForm.name,\r\n                        mid:THIS.ruleForm.mid,\r\n                        type:THIS.ruleForm.type,\r\n                        address:THIS.ruleForm.address,\r\n                        desc:THIS.ruleForm.desc,\r\n                        standard:THIS.ruleForm.standard,\r\n                        cycle:THIS.ruleForm.cycle,\r\n                        fee:THIS.ruleForm.fee,\r\n                        pid:THIS.ruleForm.pid,\r\n                        cooperation_start:THIS.ruleForm.cooperation[0],\r\n                        cooperation_end:THIS.ruleForm.cooperation[1],\r\n                        report_start:THIS.ruleForm.report[0],\r\n                        report_end:THIS.ruleForm.report[1],\r\n                        number:THIS.ruleForm.number,\r\n                        education:THIS.ruleForm.education\r\n                    };\r\n                    var url = '';\r\n                    if(THIS.id){\r\n                        data.id = THIS.id;\r\n                        url = '/task/edit'\r\n                    }else{\r\n                        url = '/task/add';\r\n                    };\r\n                    vue_Post(THIS,url,data,callback,1,1,1,1);\r\n                    function callback(msg){\r\n                        THIS.$message({\r\n                            type: 'success',\r\n                            message: THIS.id?'编辑成功':'创建成功',\r\n                            dangerouslyUseHTMLString:true\r\n                        });\r\n                        THIS.isBack = false;\r\n                        THIS.$router.replace(THIS.link);\r\n                    }; \r\n            },\r\n\r\n            get_detail(){\r\n                var data = {\r\n                    id:THIS.id\r\n                };\r\n                vue_Post(THIS,'/task/get',data,callback,1,1,0,1);\r\n                function callback(msg){\r\n                    msg = msg.info;\r\n                    THIS.ruleForm = {\r\n                        name:msg.name,\r\n                        mid:msg.mid,\r\n                        type:msg.type,\r\n                        address:msg.address,\r\n                        desc:msg.desc,\r\n                        standard:msg.standard,\r\n                        cycle:msg.cycle,\r\n                        fee:msg.fee,\r\n                        pid:msg.pid,\r\n                        cooperation:[msg.cooperation_start,msg.cooperation_end],\r\n                        report:[msg.report_start,msg.report_end],\r\n                        number:msg.number,\r\n                        education:msg.education,\r\n                    };\r\n                    THIS.get_type();\r\n                }\r\n            },\r\n\r\n            //获取服务商\r\n            search_pid(msg){\r\n                var data = {\r\n                    name:msg,\r\n                    size:300\r\n                };\r\n                vue_Post(THIS,'/platform/list',data,callback,0,0,0,0);\r\n                function callback(msg){\r\n                    THIS.pidArr = msg.list.map(item=>{\r\n                        return { title:item.name,id:item.id }\r\n                    });\r\n                }\r\n            },\r\n\r\n            //获取发包方\r\n            search_mid(msg){\r\n                var data = {\r\n                    name:msg,\r\n                    size:300\r\n                };\r\n                vue_Post(THIS,'/merchant/list',data,callback,0,0,0,0);\r\n                function callback(msg){\r\n                    console.log(1000)\r\n                    THIS.midArr = msg.list.map(item=>{\r\n                        return { title:item.m_name,id:item.id }\r\n                    });\r\n                }\r\n            },\r\n\r\n            get_type(){\r\n                var data = {\r\n                    id:THIS.ruleForm.mid\r\n                };\r\n                vue_Post(THIS,'/merchant/getProtocol',data,callback,0,0,0,0);\r\n                function callback(msg){\r\n                    THIS.typeArr = msg;\r\n                    console.log(THIS.typeArr);\r\n                }\r\n            },\r\n\r\n            changeMid(flag){\r\n                if(!flag&&THIS.ruleForm.mid){\r\n                   THIS.get_type();\r\n                };\r\n            },\r\n\r\n    },\r\n    mounted(){\r\n        THIS = this;\r\n        THIS.store.commit('setPageText','任务管理 / 任务编辑');\r\n        THIS.id = THIS.$route.params.id?THIS.$route.params.id:'';\r\n        THIS.userType = window.localStorage.userType;\r\n        if(THIS.id){\r\n            THIS.get_detail();\r\n        }else{\r\n            THIS.get_type();\r\n        };\r\n        THIS.search_pid('');\r\n        THIS.search_mid('');\r\n        \r\n        \r\n    },\r\n    beforeDestroy(){\r\n        THIS.store.commit('setPageText','当前位置：任务管理 / 任务列表');\r\n    },\r\n    beforeRouteLeave(to, from, next){//删除：清除缓存页面缓存  返回：缓存上一页面\r\n        if(!THIS.isBack){\r\n            to.meta.keepAlive = false; \r\n        };\r\n        next();\r\n    },\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n   \r\n</style>\r\n"]}]}